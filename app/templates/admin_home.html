
<!doctype html><html><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1">
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet"><title>Admin - Einsätze</title></head>
<body class="bg-light"><div class="container py-4">
<h1 class="mb-3">Einsätze</h1>
<div class="d-flex gap-2 mb-3">
  <a class="btn btn-outline-secondary" href="/admin/{{ token }}/staff">Team</a>
  <a class="btn btn-outline-secondary" href="/admin/{{ token }}/apartments">Apartments</a>
  <a class="btn btn-primary" href="/admin/{{ token }}/import">Import jetzt</a>
</div>
<table class="table table-sm table-hover bg-white align-middle">
<thead><tr><th>Datum</th><th>Apartment</th><th>Geplant</th><th>Next Arrival</th><th>MA</th><th>Lock</th><th>Aktionen</th></tr></thead>
<tbody>
{% for t in tasks %}
<tr>
  <td>{{ t.date }}</td>
  <td>{{ t.apartment_id }}</td>
  <td>{{ t.planned_minutes }} min</td>
  <td>
    {% if t.next_arrival %}
      {{ t.next_arrival }} ({{ t.next_arrival_adults or 0 }}+{{ t.next_arrival_children or 0 }})<br>
      <small class="text-muted">{{ t.next_arrival_comments }}</small>
    {% else %}-{% endif %}
  </td>
  <td>
    <form method="post" action="/admin/{{ token }}/task/assign" class="d-flex gap-2">
      <input type="hidden" name="task_id" value="{{ t.id }}"/>
      <select name="staff_id" class="form-select form-select-sm">
        <option value="">–</option>
        {% for s in staff %}
          <option value="{{ s.id }}" {% if t.assigned_staff_id==s.id %}selected{% endif %}>{{ s.name }}</option>
        {% endfor %}
      </select>
      <button class="btn btn-sm btn-outline-primary">Speichern</button>
    </form>
  </td>
  <td>
    <form method="post" action="/admin/{{ token }}/task/lock">
      <input type="hidden" name="task_id" value="{{ t.id }}"/>
      <input type="hidden" name="lock" value="{{ 0 if t.locked else 1 }}"/>
      <button class="btn btn-sm {{ 'btn-success' if t.locked else 'btn-outline-secondary' }}">{{ 'Locked' if t.locked else 'Lock' }}</button>
    </form>
  </td>
  <td><small>#{{ t.id }}</small></td>
</tr>
{% endfor %}
</tbody></table>
</div></body></html>
